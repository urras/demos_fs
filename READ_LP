
LP

ИМЯ
     lp - печатающие устройства.

ОПИСАНИЕ
      Специальный  файл  (драйвер) обеспечивает  работу  с  различными
     печающими   устройствами  ( СМ 6302,  DZM-180,  СМ 6315,  СМ 6900,
     ROBOTRON СМ 6329, D100, D100M, EPSON FX-800, EPSON LX-800 и т.д.),
     подключенными  через параллельный интерфейс. Драйвер поддерживает
     печатающие устройства,  работающие  в  различных  кодовых наборах
     КОИ-7 H0 и КОИ-7 H1, КОИ-7 H0/1, КОИ-8, основная по ГОСТ).

      Первоначально считается, что подключен принтер типа LX-800. Если
     принтер не поддерживает систему команд EPSON и число строк превы-
     шает заданный размер страницы, то выдается  символ  прогона  фор-
     мата  ("\f").  Если принтер не поддерживает контроль длины строки
     и число символов превышает заданный размер  строки,  то  выдается
     символ перевода строки ("\n").

      Драйвер печатающего устройства соответствующим образом интерпре-
     тирует  символы  <возврат каретки>  ("\r", CR), <шаг назад> ("\b",
     BS), <табуляция> ("\t", TAB), <прогон формата> ("\f", FF) и <пере-
     вод строки> ("\n", NL).

      Существует также возможность изменять данные соглашения. Системный
     вызов:

          struct lpmodes lp;
          ioctl (fd, LPIOGETP, &lp)

     читает текущие режимы работы драйвера и записывает в lp. Структура
     lp имеет следующий вид и первоначальные значения параметров:

          struct lpmodes {
	     short lpm_flags  = LPLX|LPINIT|LPINCH;  /* Режимы работы */
	     short lpm_maxcol = 160;           /* Число знакомест в строке */
	     short lpm_ejline = 72;            /* Число строк на листе */
	     short lpm_inch   = 12;            /* Длина листа в дюймах */
	     short lpm_vint   = 12;            /* Интервал между строками */
	     short lpm_shrift = 0;             /* Номер шрифта */
	     short lpm_skip   = 6;             /* Число пропускаемых строк */
	     short lpm_left   = 0;             /* Левое поле отступа */
          };

      Поле  lpm_flags является шкалой режимов работы драйвера и состав-
     ляется из следующих признаков:

LPOPEN          устройство занято;

LPON            устройство включено. Эти два признака можно только про-
		читать.

LPCAP           устройство имеет прописные и строчные буквы. Если пред-
		полагается,  что устройство может отображать набор зна-
		ков, в который входят только специальные символы,  рус-
		ские и латинские прописные буквы, то сбросив флаг LPCAP
		можно переводить строчные буквы  в  прописные,  а также
		переводить некоторые спецсимволы:

		------------------------------
		! Входной !  Выдаваемый      !
		!---------!------------------!
		!   {     ! ( <шаг назад> -  !
		!   }     ! ) <шаг назад> -  !
		!   |     ! ! <шаг назад> -  !
		!   `     ! ' <шаг назад> -  !
		------------------------------

LPRAW           установка прозрачного  режима.  Символы  выводятся  без
		всякой обработки. Имеет повышенный приоритет среди фла-
		гов.

LPCYRILL        русский алфавит.  Если флаги  LPCAP  и  LPSISO сброшены,
		считается,  что  устройство  отображает  кодовый  набор
		КОИ-7 H0/1;

LPSISO          eсли заданы режимы LPCYRILL и LPCAP, считается что уст-
		ройство отображает полный знаковый  набор переключением
		регистров  русский/латинский символами  SI/SO (016/017)
		(КОИ-7 H0  и  КОИ-7 H1).  Если  в  аналогичной ситуации
		LPSISO не установлен, считается, что устройство отобра-
		жает кодовый набор  КОИ-8  и  переключения регистров не
		требуется;

LPZNAK          печать  апострофа  "'"  вместо  прописного  и строчного
		твердого знака;

LPCLEAR         используется,  если  после  прерывания  процесса печати
		устройство находится в состоянии  "занято" и необходимо
		срочно прекратить печатать файл.  Следует помнить,  что
		устройства,  имеющие  буфер  данных,  будут  продолжать
		печатать данные до исчерпания буфера;

LPROB           печатающее устройство типа ROBOTRON 6329;

LPLX            печатающее устройство типа EPSON LX-800;

LPFX            печатающее устройство типа EPSON FX-800;

LPD100          печатающее устройство типа D100M.

	Допускается использование только одного из флагов
      ( LPROB | LPLX | LPFX | LPD100 ).

LPINIT          инициализация печатающего устройства  после  его откры-
		тия перед печатью файла;

LPHTB           при отмене этого флага  код табуляции заменяется пробе-
		лами;

LPINCH          установка длины  страницы  в  дюймах.  При отмене этого
		флага длина страницы задается в строках;

LPNLQ           установка качественного шрифта.

	Для  установки  новых  режимов работы драйвера служит системный
       вызов:

          ioctl (fd, LPIOSETP, &lp);

	    Рекомендуемые  значения  флагов  для  различных  печатающих
       устройств:

							      ТАБЛИЦА 1

	     LPROB LPFX LPLX LPD100 LPCYRILL LPSISO LPCAP LPZNAK LPINIT LPHTB
FX-800         -    +    -     -       -       -      -     -      +      +

LX-800,        -    -    +     -       -       -      -     -      +      -
RAVI-800X,
СМ 6337
(основная)

D100           -    -    -     +       +       -      +     -      -      -
(КОИ-8)
D100M          -    -    -     +       +       -      +     -      +      -
(КОИ-8)
D100M          -    -    -     +       +       +      +     -      +      -
(H0 и H1)
DZM-180        -    -    -     -       +       -      -     +      -      -

ROBOTRON       +    -    -     -       +       +      +     +      +      +
(H0 и H1)
ROBOTRON       +    -    -     -       +       -      -     -      +      +
(H0/1)

							      ТАБЛИЦА 2

	    Положение переключателей на принтерах  FX-800/1000,  LX-800
	      -----------------------------------
	      ! Номер переклю- !     Положение  !
	      ! чателя         !                !
	      !----------------!----------------!
	      !    1-1         !       OFF      !
	      !    1-2         !       OFF      !
	      !    1-3         !       OFF      !
	      !    1-4         !       ON       !
	      !    1-5         !       OFF      !
	      !    1-6         !       ON       !
	      !    1-7         !       ON       !
	      !    1-8         !       ON       !
	      !    2-1         !       ON       !
	      !    2-2         !       OFF      !
	      !    2-3         !       OFF      !
	      !    2-4         !       OFF      !
	      -----------------------------------

							      ТАБЛИЦА 3

	    Положение переключателей на принтере СМ 6337
	      --------------------------------------
	      ! S5 !  Положение !! S6  ! Положение !
	      !----!------------!!-----!-----------!
	      ! 1  !      0     !! 1   !     1     !        0 - "на себя"
	      ! 2  !      1     !! 2   !     1     !
	      ! 3  !      1     !! 3   !     1     !
	      ! 4  !      1     !! 4   !     1     !
	      ! 5  !      0     !! 5   !     1     !
	      ! 6  !      0     !! 6   !     1     !
	      ! 7  !      1     !! 7   !     0     !
	      ! 8  !      1     !! 8   !     0     !
	      --------------------------------------

							      ТАБЛИЦА 4

	    Положение переключателей на принтере D-100M (КОИ-8).
	      ----------------------------------
	      ! Номер переклю- !    Положение  !
	      ! чателя         !               !
	      !----------------!---------------!
	      !    1.1         !       ON      !
	      !    1.2         !       OFF     !
	      !    1.3         !       OFF     !
	      !    1.4         !       OFF     !
	      !    1.5         !       ON      !
	      !    1.6         !       ON      !
	      !    1.7         !       OFF     !
	      !    1.8         !       ON      !
	      !    2.1         !       ON      !
	      !    2.2         !       ON      !
	      !    2.3         !       ON      !
	      !    2.4         !       ON      !
	      !    2.5         !       OFF     !
	      !    2.6         !       ON      !
	      !    2.7         !       OFF     !
	      !    2.8         !       OFF     !
	      ----------------------------------

							      ТАБЛИЦА 5

	    Положение переключателей на принтере ROBOTRON-6329.
	      -----------------------------------
	      ! Номер переклю- !     Положение  !
	      ! чателя         !                !
	      !----------------!----------------!
	      !    7-1         !       OFF      !
	      !    7-2         !       OFF      !
	      !    8-1         !       OFF      !
	      !    8-2         !       ON       !
	      !    9-1         !       OFF      !
	      !    9-2         !       OFF      !
	      -----------------------------------

ФАЙЛЫ
     /usr/include/sys/ioctl.h
     /etc/lptab - описание конфигурации печатающих устройств.

ДОПОЛНИТЕЛЬНЫЕ ССЫЛКИ
     lpr(1), lpq(1), lprm(1), lpset, lptab

      Следует учитывать, что смена режимов работы драйвера распростра-
     няется не только текущий, но и на все последующие процессы, кото-
     рые будут обращаться к этому устройству.  Не  следует производить
     смену режимов работы драйвера  во время печати файла данных,  что
     может привести к непредсказуемым последствиям.


-------------------------------------------------------------------------


LPTAB


ИМЯ
     /etc/lptab - файл описаний конфигурации печатающих устройств.

ОПИСАНИЕ
      Файл /etc/lptab содержит информацию о параметрах и типах печата-
     ющих  устройств.  Каждая строка описывает одно устройство  и сос-
     тоит из одинадцати полей:

  Tprinter:dev:type:width:length:leinch:shrift:vint:left:skip:flags:filter

      Символ  ":"  является разделителем полей.  Первый  символ строки
     (T) определяет тип устройства:

     L   печатающее устройство на данной вычислительной комплексе;

     T   устройство, подключенное на терминальную линию связи;

     O   устройство  с  нестандартным  интерфейсом  или  не  требующее
         установки параметров;

     R   устройство на удаленной системе;

     X   строка считается комментарием.

      Остальные поля имеют следующее значение:

     printer
	  - Имя логического печатающего устройства. Несколько  различ-
	    ных логических печатающих устройств могут  соответствовать
	    одному  физическому.   Имена  логических  печатающих  уст-
            ройств не должны совпадать.

     dev  - Имя специального файла, обслуживающего доступ к физическо-
	    му устройству печати.

     type - Полное название устройства.  Обычно соответствует  номенк-
	    латурному  названию изделия  и используется в чисто инфор-
            мационных целях.

     width
          - Максимальное число символов в строке.

     length
          - Число строк на листе.

     leinch
	  - Длина страницы в дюймах.

     shrift
	  - Номер шрифта.

     vint
	  - Интервал между строками.

     left
	  - Поле отступа от левого края листа.

     skip
	  - Число строк, пропускаемых между страницами.

     flags
	  - Список параметров настройки драйвера устройства.  Для уст-
	    ройств типа  "T"  имена  параметров  соответстуют парамет-
	    рам команды stty(1),  для устройств  типа  "L"  -  команде
	    lpset. В качестве символа-разделителя параметров использу-
	    ется ",".

     filter
	  - Строка команд интерпретатора  sh(1), которые  используются
            как фильтр печати.

      При описании фильтра могут применяться макропеременные sh  $DEV,
     $TYPE,  $WIDTH  и $LENGTH, значения которых во время печати будут
     соответствовать одноименным полям описания устройства. Переменные
     $SLOT, $USER, $FILE и $MSG определяют, соответственно:

     -    номер   строки,  описывающей  данноe  устройство   в   файле
          /etc/lptab;

     -    имя пользователя, который печатает файл;

     -    имя выводимого файла;

     -    язык диагностики (см. environ(7)).

ДОПОЛНИТЕЛЬНЫЕ ССЫЛКИ
     print(1), lpr(1), stty(1), lpset, lp_daemon(8), lp

ЗАМЕЧАНИЯ
      Работа с АЦПУ на удаленных машинах еще не реализована.

      Возможно использование системы спулинга не только для алфавитно-
     цифровых печатающих устройств,  но  и  для графических устройств,
     вывода перфолент и т.д.


---------------------------------------------------------------------


LPSET

ИМЯ
     lpset - установка режима работы драйвера печати.

ФОРМАТ

lpset [флаги] [width NN] {[length NN] | [leinch NN]} [shrift NN] [vint NN]
	      [skip NN] [left NN]
Флаги: {[-]fx | [-]lx | [-]rob | [-]d100} [-]init [-]tab [-]cap [-]cyrill
	[-]nlq [-]siso [-]znak [-]raw clear

ОПИСАНИЕ
      Команда  lpset  позволяет  устанавливать различные режимы работы
     печатающего устройства.  Если не задано ни одного ключа или флага,
     в  стандартный файл вывода выводится информация о текущих режимах
     печати.

КЛЮЧИ

-width          установка  ширины  страницы.  NN  меняется в диапазоне
		10 - 160.

-length         установка длины страницы в строках. NN меняется в диа-
		пазоне 1 -127. Число печатаемых на стрнице строк опре-
		деляется как   length - skip;

-leinch         установка длины страницы в дюймах.  NN меняется в диа-
		пазоне 1 - 22;

-skip           установка числа строк,  пропускаемых между страницами.
		NN меняется в диапазоне 1 - 127;

      Следующие три ключа имеют смысл только, если печать поддерживает
     систему команд EPSON.

-shrift         установка типа шрифта. меняется в диапазоне 0 - 255;

-vint           установка  NN/72 - дюймового интервала между строками.
		NN меняется в диапазоне 0 - 85;

-left           установка поля отступа от левого края листа.  NN меня-
		еся в диапазоне 0 - 150;


ФЛАГИ

-raw            установка  прозрачного режима.  Символы  выводятся без
		всякой  обработки;

-fx             печатающее устройство типа EPSON FX-800;

-lx             печатающее устройство типа EPSON LX-800;

-rob            печатающее устройство типа ROBOTRON 6329;

-d100           печатающее устройство типа D100M;

-init           инициализация печатающего устройства  после его откры-
		тия перед печатью файла;

-tab            при отмене этого флага код табуляции заменяется пробе-
		лами;

-cyrill         русский  алфавит.  Если  флаги  cap  и  siso сброшены,
		считается,  что  устройство  отображает  кодовый набор
		КОИ-7 H0/1;

-siso           eсли заданы режимы cyrill и cap,  считается  что  уст-
		ройство отображает полный знаковый набор переключением
		регистров русский/латинский символами  SI/SO (016/017)
		(КОИ-7 H0 и КОИ-7 H1).  Если  в  аналогичной  ситуации
		siso  не установлен, считается, что устройство отобра-
		жает кодовый набор КОИ-8  и переключения  регистров не
		требуется;

-znak           печать  апострофа  "'"  вместо  прописного и строчного
		твердого знака;

-cap            устройство имеет прописные и строчные буквы;

clear           используется,  если  после  прерывания процесса печати
		устройство находится в состоянии "занято" и необходимо
		срочно прекратить печатать файл.  Следует помнить, что
		устройства,  имеющие  буфер  данных,  будут продолжать
		печатать данные до исчерпания буфера;


ДОПОЛНИТЕЛЬНЫЕ ССЫЛКИ
     lpr(1), lp, lptab



